{
 "add_total_row": 1, 
 "apply_user_permissions": 0, 
 "creation": "2019-04-28 12:06:18.049099", 
 "disabled": 0, 
 "docstatus": 0, 
 "doctype": "Report", 
 "idx": 0, 
 "is_standard": "Yes", 
 "modified": "2019-05-01 22:39:31.831144", 
 "modified_by": "Administrator", 
 "module": "PLE-PERU", 
 "name": "PLE Compras", 
 "owner": "Administrator", 
 "query": "(select      \n\t\t\t\tCONCAT(DATE_FORMAT(IFNULL(posting_date,bill_date),'%%Y%%m'),'00') as \"PERIODO:Data:100\",\n\t\t\t\tREPLACE(purchase_invoice.name, '-', '') as \"NUMERO CORRELATIVO O CODIGO UNICO DE LA OPERACI\u00d3N:Data:100\",\n\t\t\t\t'M2' as \"SECUENCIA:Data:100\",\n\t\t\t\tDATE_FORMAT(IFNULL(bill_date,posting_date),'%%d/%%m/%%Y') as \"FECHA DE EMISI\u00d3N DEL COMPROBANTE DE PAGO O DOCUMENTO:Date:120\",\n\t\t\t\tDATE_FORMAT(IFNULL(bill_expiration_date,posting_date),'%%d/%%m/%%Y') as \"FECHA DE VENCIMIENTO O FECHA DE PAGO:Date:120\",\n\t\t\t\tIF(LENGTH(codigo_comprobante) = 1,CONCAT('0',codigo_comprobante), codigo_comprobante) as \"TIPO DE COMPROBANTE DE PAGO O DOCUMENTO:Link/Tipos de Comprobante:100\",\n\t\t\t\tbill_series as \"SERIE DE COMPROBANTE DE PAGO O DOCUMENTO:Data:150\",\n\t\t\t\t\"\" as \"A\u00d1O DUAL O DSI:Data\",\n\t\t\t\tbill_no as \"NUMERO DE COMPROBANTE DE PAGO O DOCUMENTO:Data\",\n\t\t\t\t\"\" as \"EN CASO DE OPTAR POR ANOTAR EL IMPORTE TOTAL DE LAS OPERACIONES DIARIAS:Data\",\n\t\t\t\tIF(LENGTH(codigo_tipo_documento)=2,SUBSTRING(codigo_tipo_documento,2),codigo_tipo_documento) as \"TIPO DOC. IDENTIDAD CLIENTE:Field/Tipos de Documento de Identidad:100\",\n\t\t\t\ttax_id as \"NUMERO DOC. IDENTIDAD CLIENTE:Data:100\",\n\t\t\t\tsupplier_name as \"APELLIDOS Y NOMBRES DENOMINACION O RAZON SOCIAL PROVEEDOR:Data:100\",\n\t\t\t\tIF(base_total_taxes_and_charges=0 OR codigo_comprobante='03', 0, base_net_total - IF(inafected_taxes_and_charges=0, 0, inafected_taxes_and_charges)) as \"BASE IMPONIBLE DE LA OPERACI\u00d3N GRAVADA:Float:120\",\n\t\t\t\tIF(codigo_comprobante!='03',total_taxes_and_charges,0) as \"IMPUESTO GENERAL A LAS VENTAS Y/O IMPUESTO DE PROMOCION MUNICIPAL:Float:120\",\n\t\t\t\t\"\" as \"BASE IMPONIBLE DE LAS ADQUISICIONES GRAVADAS DESTINADAS A OPERACIONES GRAVADAS Y/O DE EXPORTACION Y A OPERACIONES NO GRAVADAS:Float:100\",\n\t\t\t\t\"\" as \"MONTO DEL IMPUESTO DE LAS ADQUISICIONES GRAVADAS DESTINADAS A OPERACIONES GRAVADAS Y/O DE EXPORTACION Y A OPERACIONES NO GRAVADAS:Float:100\",\n\t\t\t\t\"\" as \"BASE IMPONIBLE DE LAS ADQUISICIONES GRAVADAS DESTINADAS A OPERACIONES NO GRAVADAS:Float:100\",\n\t\t\t\t\"\" as \"MONTO DEL IMPUESTO DE LAS ADQUISICIONES GRAVADAS DESTINADAS A OPERACIONES NO GRAVADAS:Float:100\",\n\t\t\t\tIF(base_total_taxes_and_charges=0, base_grand_total, IF(inafected_taxes_and_charges=0, 0, inafected_taxes_and_charges)) as \"VALOR DE LAS ADQUISICIONES NO GRAVADAS:Float:100\",\n\t\t\t\t\"\" as \"MONTO DEL IMPUESTO SELECTIVO AL CONSUMO EN LOS CASOS EN QUE EL SUJERO PUEDA UTILIZARLO COMO DEDUCCION:Float:100\",\n\t\t\t\t\"\" as \"OTROS CONCEPTOS, TRIBUTOS Y CARGOS QUE NO FORMEN PARTE DE LA BASE IMPONIBLE:Float:100\",\t\t\t\n\t\t\t\tbase_grand_total as \"IMPORTE TOTAL DE LAS ADQUISICIONES REGISTRADAS SEGUN COMPROBANTE DE PAGO:Float:100\",\n\t\t\t\tIF(currency = 'SOL', 'PEN', currency) as \"MONEDA:Link/Currency\",\n\t\t\t\tSUBSTRING(conversion_rate,1,POSITION('.' in conversion_rate)+3)  as \"TIPO DE CAMBIO:Float:120\",\n\t\t\t\tIF(is_return,(SELECT purchase_return.bill_date FROM `tabPurchase Invoice` as purchase_return WHERE purchase_return.name=purchase_invoice.return_against),\"\") as \"FECHA DE REF. DEL COMPROBANTE DE PAGO  O DOCUMENTO  MODIFICADO:Date:120\",\n\t\t\t\tIF(is_return,(SELECT purchase_return.codigo_comprobante FROM `tabPurchase Invoice`as purchase_return WHERE purchase_return.name=purchase_invoice.return_against),\"\") as \"TIPO DE REF. DEL COMPROBANTE DE PAGO  O DOCUMENTO MODIFICADO:Link/Tipos de Comprobante:100\",\n\t\t\t\tIF(is_return,(SELECT purchase_return.bill_series FROM `tabPurchase Invoice`as purchase_return WHERE purchase_return.name=purchase_invoice.return_against),\"\") as \"SERIE DE REF. DEL COMPROBANTE DE PAGO  O DOCUMENTO MODIFICADO:Data:100\",\n\t\t\t\t\"\" as \"CODIGO DEP. ADUANERA DE LA DECLARACION UNICA DE ADUANES (DUA) O DECLARACION SIMPLIFICA DE IMPORTACION (DSI):Data:100\",\n\t\t\t\tIF(is_return,(SELECT purchase_return.bill_no FROM `tabPurchase Invoice` as purchase_return WHERE name=purchase_invoice.return_against),\"\") as \"NUMERO DE REF. DEL COMPROBANTE DE PAGO  O DOCUMENTO MODIFICADO:Data:100\",\n\t\t\t\t\"\" as \"FECHA DE EMISI\u00d3N DE LA CONSTANCIA DE DEPOSITO DE DETRACCION:Data:100\",\n\t\t\t\t\"\" as \"NUMERO DE EMISI\u00d3N DE LA CONSTANCIA DE DEPOSITO DE DETRACCION:Data:100\",\n                \"\" as \"MARCA DEL COMPROBANTE DE PAGO SUJETO A RETENCION:Data:100\",\n\t\t\t\t\"\" as \"CLASIFICACION DE LOS BIENES Y SERVICIOS ADQUIRIDOS:Data:100\",\n\t\t\t\t\"\" as \"IDENTIFICACION DEL CONTRATO, PROYECTO EN EL CASO DE LOS OPERADORES DE LAS SOCIEDADES IRREGULARES, JOINT VENTURES:Data:100\",\n\t\t\t\t\"\" as \"ERROR TIPO 1: INCONSISTENCIA EN EL TIPO DE CAMBIO:Data:100\",\n\t\t\t\t\"\" as \"ERROR TIPO 2: INCONSISTENCIA POR PROVEEDORES NO HABIDOS:Data:100\",\n\t\t\t\t\"\" as \"ERROR TIPO 3: INCONSISTENCIA POR PROVEEDORES QUE RENUNCIARON A LA EXONEARACION DEL APENDICE DEL IGV:Data:100\",\n\t\t\t\t\"\" as \"ERROR TIPO 4: INCONSISTENCIA POR DNIs QUE FUERON UTILIZADOS EN LAS LIQUIDACIONES QUE YA CUENTAN CON RUC:Data:100\",\n\t\t\t\t'1' as \"INDICADOR DE COMPROBANTES DE PAGO CANCELADOS CON MEDIOS DE PAGO:Data:100\",\n\t\t\t\tIF(is_return,(SELECT IF(bill_date>=%(from_date)s AND bill_date<=%(to_date)s,'1','9') FROM `tabPurchase Invoice` WHERE name=return_against),IF(total_taxes_and_charges=0,'0',IF(bill_date>=%(from_date)s AND bill_date<=%(to_date)s,'1','6'))) as \"ESTADO QUE IDENTIFICA LA OPORTUNIDAD DE LA ANOTACION O INDICACION SI ESTA CORRESPONDE A UN AJUSTE:Data:100\"\n\t\t\tfrom\n\t\t\t\t`tabPurchase Invoice` purchase_invoice\n\t\t\twhere posting_date >= %(from_date)s \n\t\t\tand posting_date <= %(to_date)s \n\t\t\tand docstatus = 1\n\t\t\tand tdx_c_checkspot = 0\n\t\t\tand codigo_comprobante!='02'\n\t\t\torder by posting_date)\nUNION\n(select      \n\t\t\t\tCONCAT(DATE_FORMAT(det.`tdx_c_figv_fechaconstancia`,'%%Y%%m'),'00') as \"PERIODO:Data:100\",\n\t\t\t\tREPLACE(purchase_invoice.name, '-', '') as \"NUMERO CORRELATIVO O CODIGO UNICO DE LA OPERACI\u00d3N:Data:100\",\n\t\t\t\t'M2' as \"SECUENCIA:Data:100\",\n\t\t\t\tDATE_FORMAT(IFNULL(bill_date,posting_date),'%%d/%%m/%%Y') as \"FECHA DE EMISI\u00d3N DEL COMPROBANTE DE PAGO O DOCUMENTO:Date:120\",\n\t\t\t\tDATE_FORMAT(IFNULL(bill_expiration_date,posting_date),'%%d/%%m/%%Y') as \"FECHA DE VENCIMIENTO O FECHA DE PAGO:Date:120\",\n\t\t\t\tIF(LENGTH(codigo_comprobante) = 1,CONCAT('0',codigo_comprobante), codigo_comprobante) as \"TIPO DE COMPROBANTE DE PAGO O DOCUMENTO:Link/Tipos de Comprobante:100\",\n\t\t\t\tbill_series as \"SERIE DE COMPROBANTE DE PAGO O DOCUMENTO:Data:150\",\n\t\t\t\t\"\" as \"A\u00d1O DUAL O DSI:Data\",\n\t\t\t\tbill_no as \"NUMERO DE COMPROBANTE DE PAGO O DOCUMENTO:Data\",\n\t\t\t\t\"\" as \"EN CASO DE OPTAR POR ANOTAR EL IMPORTE TOTAL DE LAS OPERACIONES DIARIAS:Data\",\n\t\t\t\tIF(LENGTH(codigo_tipo_documento)=2,SUBSTRING(codigo_tipo_documento,2),codigo_tipo_documento) as \"TIPO DOC. IDENTIDAD CLIENTE:Field/Tipos de Documento de Identidad:100\",\n\t\t\t\ttax_id as \"NUMERO DOC. IDENTIDAD CLIENTE:Data:100\",\n\t\t\t\tsupplier_name as \"APELLIDOS Y NOMBRES DENOMINACION O RAZON SOCIAL PROVEEDOR:Data:100\",\n\t\t\t\tIF(base_total_taxes_and_charges=0 OR codigo_comprobante='03', 0, base_net_total - IF(inafected_taxes_and_charges=0, 0, inafected_taxes_and_charges)) as \"BASE IMPONIBLE DE LA OPERACI\u00d3N GRAVADA:Float:120\",\n\t\t\t\tIF(codigo_comprobante!='03',total_taxes_and_charges,0) as \"IMPUESTO GENERAL A LAS VENTAS Y/O IMPUESTO DE PROMOCION MUNICIPAL:Float:120\",\n\t\t\t\t\"\" as \"BASE IMPONIBLE DE LAS ADQUISICIONES GRAVADAS DESTINADAS A OPERACIONES GRAVADAS Y/O DE EXPORTACION Y A OPERACIONES NO GRAVADAS:Float:100\",\n\t\t\t\t\"\" as \"MONTO DEL IMPUESTO DE LAS ADQUISICIONES GRAVADAS DESTINADAS A OPERACIONES GRAVADAS Y/O DE EXPORTACION Y A OPERACIONES NO GRAVADAS:Float:100\",\n\t\t\t\t\"\" as \"BASE IMPONIBLE DE LAS ADQUISICIONES GRAVADAS DESTINADAS A OPERACIONES NO GRAVADAS:Float:100\",\n\t\t\t\t\"\" as \"MONTO DEL IMPUESTO DE LAS ADQUISICIONES GRAVADAS DESTINADAS A OPERACIONES NO GRAVADAS:Float:100\",\n\t\t\t\tIF(base_total_taxes_and_charges=0, base_grand_total, IF(inafected_taxes_and_charges=0, 0, inafected_taxes_and_charges)) as \"VALOR DE LAS ADQUISICIONES NO GRAVADAS:Float:100\",\n\t\t\t\t\"\" as \"MONTO DEL IMPUESTO SELECTIVO AL CONSUMO EN LOS CASOS EN QUE EL SUJERO PUEDA UTILIZARLO COMO DEDUCCION:Float:100\",\n\t\t\t\t\"\" as \"OTROS CONCEPTOS, TRIBUTOS Y CARGOS QUE NO FORMEN PARTE DE LA BASE IMPONIBLE:Float:100\",\t\t\t\n\t\t\t\tbase_grand_total as \"IMPORTE TOTAL DE LAS ADQUISICIONES REGISTRADAS SEGUN COMPROBANTE DE PAGO:Float:100\",\n\t\t\t\tIF(currency = 'SOL', 'PEN', currency) as \"MONEDA:Link/Currency\",\n\t\t\t\tSUBSTRING(conversion_rate,1,POSITION('.' in conversion_rate)+3)  as \"TIPO DE CAMBIO:Float:120\",\n\t\t\t\tIF(is_return,(SELECT purchase_return.bill_date FROM `tabPurchase Invoice` as purchase_return WHERE purchase_return.name=purchase_invoice.return_against),\"\") as \"FECHA DE REF. DEL COMPROBANTE DE PAGO  O DOCUMENTO  MODIFICADO:Date:120\",\n\t\t\t\tIF(is_return,(SELECT purchase_return.codigo_comprobante FROM `tabPurchase Invoice`as purchase_return WHERE purchase_return.name=purchase_invoice.return_against),\"\") as \"TIPO DE REF. DEL COMPROBANTE DE PAGO  O DOCUMENTO MODIFICADO:Link/Tipos de Comprobante:100\",\n\t\t\t\tIF(is_return,(SELECT purchase_return.bill_series FROM `tabPurchase Invoice`as purchase_return WHERE purchase_return.name=purchase_invoice.return_against),\"\") as \"SERIE DE REF. DEL COMPROBANTE DE PAGO  O DOCUMENTO MODIFICADO:Data:100\",\n\t\t\t\t\"\" as \"CODIGO DEP. ADUANERA DE LA DECLARACION UNICA DE ADUANES (DUA) O DECLARACION SIMPLIFICA DE IMPORTACION (DSI):Data:100\",\n\t\t\t\tIF(is_return,(SELECT purchase_return.bill_no FROM `tabPurchase Invoice` as purchase_return WHERE name=purchase_invoice.return_against),\"\") as \"NUMERO DE REF. DEL COMPROBANTE DE PAGO  O DOCUMENTO MODIFICADO:Data:100\",\n\t\t\t\tDATE_FORMAT(det.`tdx_c_figv_fechaconstancia`,'%%d/%%m/%%Y') as \"FECHA DE EMISI\u00d3N DE LA CONSTANCIA DE DEPOSITO DE DETRACCION:Data:100\",\n\t\t\t\tdet.`tdx_c_figv_constancia` as \"NUMERO DE EMISI\u00d3N DE LA CONSTANCIA DE DEPOSITO DE DETRACCION:Data:100\",\n                \"\" as \"MARCA DEL COMPROBANTE DE PAGO SUJETO A RETENCION:Data:100\",\n\t\t\t\t\"\" as \"CLASIFICACION DE LOS BIENES Y SERVICIOS ADQUIRIDOS:Data:100\",\n\t\t\t\t\"\" as \"IDENTIFICACION DEL CONTRATO, PROYECTO EN EL CASO DE LOS OPERADORES DE LAS SOCIEDADES IRREGULARES, JOINT VENTURES:Data:100\",\n\t\t\t\t\"\" as \"ERROR TIPO 1: INCONSISTENCIA EN EL TIPO DE CAMBIO:Data:100\",\n\t\t\t\t\"\" as \"ERROR TIPO 2: INCONSISTENCIA POR PROVEEDORES NO HABIDOS:Data:100\",\n\t\t\t\t\"\" as \"ERROR TIPO 3: INCONSISTENCIA POR PROVEEDORES QUE RENUNCIARON A LA EXONEARACION DEL APENDICE DEL IGV:Data:100\",\n\t\t\t\t\"\" as \"ERROR TIPO 4: INCONSISTENCIA POR DNIs QUE FUERON UTILIZADOS EN LAS LIQUIDACIONES QUE YA CUENTAN CON RUCData:100\",\n\t\t\t\t'1' as \"INDICADOR DE COMPROBANTES DE PAGO CANCELADOS CON MEDIOS DE PAGO:Data:100\",\n\t\t\t\tIF(is_return,(SELECT IF(bill_date>=%(from_date)s AND bill_date<=DATE_ADD(%(to_date)s, INTERVAL 5 DAY),'1','9') FROM `tabPurchase Invoice` WHERE name=return_against),IF(total_taxes_and_charges=0,'0',IF(bill_date>=%(from_date)s AND bill_date<=DATE_ADD(%(to_date)s, INTERVAL 5 DAY),'1','6'))) as \"ESTADO QUE IDENTIFICA LA OPORTUNIDAD DE LA ANOTACION O INDICACION SI ESTA CORRESPONDE A UN AJUSTE:Data:100\"\n\t\t\tfrom\n\t\t\t\t`tabPurchase Invoice` purchase_invoice,\n\t\t\t\t`tabFiscalizacion del IGV Compra` det\n\t\t\twhere det.parent = purchase_invoice.name\n\t\t\tand det.`tdx_c_figv_fechaconstancia` >= %(from_date)s \n\t\t\tand det.`tdx_c_figv_fechaconstancia` <= DATE_ADD(%(to_date)s, INTERVAL 5 DAY)\n\t\t\tand purchase_invoice.docstatus = 1\n\t\t\tand codigo_comprobante!='02'\n\t\t\torder by det.`tdx_c_figv_fechaconstancia`)", 
 "ref_doctype": "Purchase Invoice", 
 "report_name": "PLE Compras", 
 "report_type": "Query Report", 
 "roles": []
}